!function(t){var e={};function i(o){if(e[o])return e[o].exports;var a=e[o]={i:o,l:!1,exports:{}};return t[o].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(o,a,function(e){return t[e]}.bind(null,a));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e){t.exports=require("express-msteams-host")},function(t,e){t.exports=require("debug")},function(t,e,i){t.exports=i(3)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(4),a=i(5),n=i(6),r=i(7),s=i(0),c=i(1)("msteams");c("Initializing Microsoft Teams Express hosted App..."),i(8).config();const p=i(9),l=o(),u=process.env.port||process.env.PORT||3007;l.use(o.json({verify:(t,e,i,o)=>{t.rawBody=i.toString()}})),l.use(o.urlencoded({extended:!0})),l.set("views",n.join(__dirname,"/")),l.use(r("tiny")),l.use("/scripts",o.static(n.join(__dirname,"web/scripts"))),l.use("/assets",o.static(n.join(__dirname,"web/assets"))),l.use(s.MsTeamsApiRouter(p)),l.use(s.MsTeamsPageRouter({root:n.join(__dirname,"web/"),components:p})),l.use("/",o.static(n.join(__dirname,"web/"),{index:"index.html"})),l.set("port",u),a.createServer(l).listen(u,()=>{c("Server running on "+u)})},function(t,e){t.exports=require("express")},function(t,e){t.exports=require("http")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("morgan")},function(t,e){t.exports=require("dotenv")},function(t,e,i){"use strict";function o(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}Object.defineProperty(e,"__esModule",{value:!0}),e.nonce={},o(i(10)),o(i(11))},function(t,e,i){"use strict";var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r};Object.defineProperty(e,"__esModule",{value:!0});const a=i(0);let n=class{};n=o([a.PreventIframe("/acPrototypeTab/index.html"),a.PreventIframe("/acPrototypeTab/login.html")],n),e.AcPrototypeTab=n},function(t,e,i){"use strict";var o=this&&this.__decorate||function(t,e,i,o){var a,n=arguments.length,r=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(n<3?a(r):n>3?a(e,i,r):a(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},a=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))((function(a,n){function r(t){try{c(o.next(t))}catch(t){n(t)}}function s(t){try{c(o.throw(t))}catch(t){n(t)}}function c(t){t.done?a(t.value):new i((function(e){e(t.value)})).then(r,s)}c((o=o.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const n=i(0),r=i(1),s=i(12),c=i(13),p=i(14),l=i(16),u=i(18),d=i(19),m=i(21),y=i(23),h=i(24),g=i(26),f=r("msteams");let b=class{constructor(t){this.activityProc=new u.TeamsActivityProcessor,this.loggedInMemberOIDs=new Map,this.conversationState=t,this.activityProc.invokeActivityHandler={onInvoke:t=>a(this,void 0,void 0,(function*(){const e=t;null!=e.activity.value.state&&this.loggedInMemberOIDs.set(e.activity.from.aadObjectId,e.activity.value.state);const i=yield this.getUserProfile(e.activity.from.aadObjectId);if("workday"===e.activity.value.tabContext.tabEntityId&&!i)return{status:200,body:{tab:{type:"auth",suggestedActions:{actions:[{type:"openUrl",value:"https://acprototype.azurewebsites.net/acPrototypeTab/login.html",title:"Sign in to this app!"}]}}}};const o=s.CardFactory.adaptiveCard(p.default),a=s.CardFactory.adaptiveCard(d.default),n=s.CardFactory.adaptiveCard(m.default),r=s.CardFactory.adaptiveCard(y.default(i)),c=s.CardFactory.adaptiveCard(l.default),u=s.CardFactory.adaptiveCard(h.default),f=s.CardFactory.adaptiveCard(g.default);let b;const w={tab:{type:"continue",value:{cards:[{card:n.content},{card:r.content},{card:a.content}]}}},x={tab:{type:"continue",value:{cards:[{card:o.content},{card:u.content},{card:c.content}]}}},v={tab:{type:"continue",value:{cards:[{card:f.content},{card:n.content},{card:r.content},{card:a.content}]}}},S={tab:{type:"continue",value:{cards:[{card:f.content},{card:o.content},{card:u.content},{card:c.content}]}}};switch(e.activity.name){case"task/fetch":b={task:{type:"continue",value:{height:"medium",width:"medium",title:"task",card:c}}};break;case"task/submit":b="workday"===e.activity.value.tabContext.tabEntityId?{task:{type:"continue",value:v}}:{task:{type:"continue",value:S}};break;case"tab/submit":b=v;break;case"tab/fetch":default:b="workday"===e.activity.value.tabContext.tabEntityId?w:x}return{status:200,body:b}}))}}onTurn(t){return a(this,void 0,void 0,(function*(){yield this.activityProc.processIncomingActivity(t)}))}getUserProfile(t){return a(this,void 0,void 0,(function*(){const e=this.loggedInMemberOIDs.get(t);if(!e)return!1;try{const t=yield c.default("https://graph.microsoft.com/v1.0/me/",{headers:{Authorization:"Bearer "+e.accessToken}}),i=yield t.json();return null==i.error?i:void 0}catch(t){f("***************** Error fetching user profile from graph ***************"),f(t)}}))}};b=o([n.BotDeclaration("/api/messages",new s.MemoryStorage,process.env.MICROSOFT_APP_ID,process.env.MICROSOFT_APP_PASSWORD),n.PreventIframe("/acPrototypeBot/acProtoBotTab.html")],b),e.AcPrototypeBot=b},function(t,e){t.exports=require("botbuilder")},function(t,e){t.exports=require("node-fetch")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(15);e.default=o},function(t){t.exports={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",spacing:"medium",size:"default",weight:"bolder",text:"More actions ✨",wrap:!0,maxLines:0},{type:"TextBlock",size:"default",isSubtle:!0,text:"Hello, nice to meet you!",wrap:!0,maxLines:0,id:"textToToggle",isVisible:!1},{type:"ColumnSet",isVisible:!1,id:"imagesToToggle",columns:[{type:"Column",items:[{style:"person",type:"Image",url:"https://picsum.photos/300?image=1025",isVisible:!1,id:"imageToToggle",altText:"sample image 1",size:"medium"}]},{type:"Column",items:[{type:"Image",url:"https://picsum.photos/300?image=433",isVisible:!1,id:"imageToToggle2",altText:"sample image 2",size:"medium"}]}]}],actions:[{type:"Action.ToggleVisibility",title:"Get started",targetElements:["textToToggle","imagesToToggle","imageToToggle2"]},{type:"Action.ShowCard",title:"Learn more",card:{type:"AdaptiveCard",body:[{type:"TextBlock",text:"Adaptive Card Tabs Spec"}],actions:[{type:"Action.OpenUrl",title:"Open in browser",url:"https://microsoft.sharepoint.com/:p:/t/ExtensibilityandFundamentals/EWCKez9sB3NEta260kfdMnkBFUu16Z9rnN-gugIqh8D5QQ?e=tBMY9U"}]}},{type:"Action.OpenUrl",title:"acPrototype",url:"https://acprototype.azurewebsites.net"},{type:"Action.Submit",title:"Advanced",data:{msteams:{type:"task/fetch"}}}]}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(17);e.default=o},function(t){t.exports={$schema:"http://adaptivecards.io/schemas/adaptive-card.json",type:"AdaptiveCard",version:"1.0",body:[{type:"Container",items:[{type:"TextBlock",text:"Video Player",weight:"Bolder",size:"Medium"}]},{type:"Container",items:[{type:"TextBlock",text:"Enter the ID of a YouTube video to play in a dialog",wrap:!0},{type:"Input.Text",id:"youTubeVideoId",value:""}]}],actions:[{type:"Action.Submit",title:"Update"}]}},function(t,e){t.exports=require("botbuilder-teams")},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(20);e.default=o},function(t){t.exports={type:"AdaptiveCard",body:[{type:"Container",bleed:!0,style:"emphasis",items:[{type:"TextBlock",text:"Admin Dashboard",color:"Dark",fontType:"Default",size:"Medium",weight:"Bolder"}],spacing:"None"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Configure the Workday App",wrap:!0},{type:"TextBlock",spacing:"None",text:"Decide what features you want enabled/disabled",isSubtle:!0,wrap:!0,fontType:"Default",weight:"Lighter"}],width:"stretch"},{type:"Column",width:"150px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"Configure"}]}]}]},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"TextBlock",weight:"Bolder",wrap:!0,text:"View Diagnostics"},{type:"TextBlock",spacing:"None",text:"Troubleshooting a problem or needing to log out",isSubtle:!0,weight:"Lighter",fontType:"Default",wrap:!0}],width:"stretch"},{type:"Column",width:"150px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"View diagnostics"}]}]}],separator:!0,spacing:"Medium"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Disconnect from Workday",wrap:!0},{type:"TextBlock",spacing:"None",text:"⚠️ Taking this action will sever all connections between Workday and Microsoft Teams for all of your users.",isSubtle:!0,wrap:!0,weight:"Lighter"}],width:"stretch"},{type:"Column",width:"150px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"Disconnect"}]}]}],separator:!0,spacing:"Medium"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Innovation Services Agreement",wrap:!0},{type:"TextBlock",spacing:"None",text:"Status: ENABLED\nCredentials: Logan McNeil (CHRO, HRExe, Mgr 4000, MatMgr, ProMgr,TalMgr,VPRept)",isSubtle:!0,wrap:!0,weight:"Lighter"}],width:"stretch"},{type:"Column",width:"150px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"Use my credentials"}]}]}],separator:!0,spacing:"Medium"}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.2"}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(22);e.default=o},function(t){t.exports={type:"AdaptiveCard",body:[{type:"TextBlock",size:"Medium",weight:"Bolder",text:"Quick actions ✨"},{type:"ActionSet",actions:[{type:"Action.Submit",title:"Take time off"},{type:"Action.Submit",title:"Look up a coworker",data:{msteams:{type:"tab/submit"}}},{type:"Action.Submit",title:"Give feedback",data:{msteams:{type:"tab/submit"}}},{type:"Action.Submit",title:"Ask Workday",data:{msteams:{type:"tab/submit"}}}],separator:!0}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.2"}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=t=>({type:"AdaptiveCard",body:[{type:"Container",bleed:!0,style:"emphasis",items:[{type:"TextBlock",text:"Manager Dashboard | 3 employees",weight:"Bolder",size:"Medium"}]},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/women/32.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:t.displayName,wrap:!0},{type:"TextBlock",spacing:"None",text:"🎉   5 year anniversary this week",isSubtle:!0,wrap:!0,fontType:"Default",weight:"Lighter"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Small"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/women/36.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",wrap:!0,text:"Alexa Edwards"},{type:"TextBlock",spacing:"None",text:"📅  Upcoming time off: Mar 20-25, Apr 1",isSubtle:!0,weight:"Lighter",fontType:"Default"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Medium"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/women/40.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Yingdan Huang",wrap:!0},{type:"TextBlock",spacing:"None",text:"🎂  Birthday this week",isSubtle:!0,wrap:!0,weight:"Lighter"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Medium"}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.2"})},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(25);e.default=o},function(t){t.exports={type:"AdaptiveCard",body:[{type:"Container",bleed:!0,style:"emphasis",items:[{type:"TextBlock",text:"Interview Candidates | 5 candidates",weight:"Bolder",size:"Medium"}]},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/men/21.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Peter Smith",wrap:!0},{type:"TextBlock",spacing:"None",text:"Software Engineer 2 | Bend, Oregon",isSubtle:!0,wrap:!0,fontType:"Default",weight:"Lighter"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Small"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/women/31.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",wrap:!0,text:"Marie Beaudoin"},{type:"TextBlock",spacing:"None",text:"Senior Product Manager | Boulder, Colorado",isSubtle:!0,weight:"Lighter",fontType:"Default"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Medium"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/women/40.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Susan Shammas",wrap:!0},{type:"TextBlock",spacing:"None",text:"Design Manager | Vancouver, British Columbia",isSubtle:!0,wrap:!0,weight:"Lighter"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Medium"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/men/40.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"Aaron Buxton",wrap:!0},{type:"TextBlock",spacing:"None",text:"Senior Software Engineer | Bend, Oregon",isSubtle:!0,wrap:!0,weight:"Lighter"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Medium"},{type:"ColumnSet",columns:[{type:"Column",items:[{type:"Image",style:"Person",url:"https://randomuser.me/api/portraits/men/3.jpg",size:"Small"}],width:"auto"},{type:"Column",items:[{type:"TextBlock",weight:"Bolder",text:"John Barry",wrap:!0},{type:"TextBlock",spacing:"None",text:"Design Manager | Seattle, Washington",isSubtle:!0,wrap:!0,weight:"Lighter"}],width:"stretch"},{type:"Column",width:"50px",items:[{type:"ActionSet",actions:[{type:"Action.Submit",title:"..."}]}]}],separator:!0,spacing:"Medium"}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.2"}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=i(27);e.default=o},function(t){t.exports={type:"AdaptiveCard",$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.2",body:[{type:"Container",items:[{type:"RichTextBlock",inlines:[{type:"TextRun",text:"✅ Success!"}]}],style:"good"}]}}]);
//# sourceMappingURL=server.js.map